import javax.xml.transform.OutputKeys;
import javax.xml.transform.Transformer;
import javax.xml.transform.TransformerException;
import javax.xml.transform.TransformerFactory;
import javax.xml.transform.stream.StreamResult;
import javax.xml.transform.stream.StreamSource;
import java.io.*;


public class Tranformator {

    private static final String XML_SOURCE = "<ELEMENT ebene=\"0\" name=\"LT-FUE\">  <OHDR>    <field name=\"Object-Name\" wert=\"NHDR\"/>    <field name=\"Object-Version\" wert=\"0001\"/>    <field name=\"Object-Len\" wert=\"00192\"/>    <field name=\"Object-Req\" wert=\"0001\"/>    <field name=\"Object-Snd\" wert=\"0001\"/>    <field name=\"Object-Fct\" wert=\"\"/>    <field name=\"Object-RetCode\" wert=\"00\"/>    <field name=\"Object-ErrCode\" wert=\"000\"/>    <field name=\"Reserve\" wert=\"\"/>  </OHDR>  <NHDR ebene=\"1\" name=\"NHDR000\">    <field name=\"NHDR-AG-ID\" wert=\"TKPORTAL\"/>    <field name=\"NHDR-ACCT-NR\" wert=\"0001000\"/>    <field name=\"NHDR-MSG-TYP\" wert=\"LT-FUE\"/>    <field name=\"NHDR-MSG-VERS\" wert=\"0012\"/>    <field name=\"NHDR-BENU-ID\" wert=\"\"/>    <field name=\"NHDR-RZ-ID\" wert=\"C\"/>    <field name=\"NHDR-FA-ID\" wert=\"0000\"/>    <field name=\"NHDR-ON-ID\" wert=\"00000\"/>    <field name=\"NHDR-MSG-LEN\" wert=\"02945\"/>    <field name=\"NHDR-NHDR-LEN\" wert=\"128\"/>    <field name=\"NHDR-OHDR-LEN\" wert=\"064\"/>    <field name=\"NHDR-SYS-EC\" wert=\"00\"/>    <field name=\"NHDR-MSG-RC\" wert=\"00\"/>    <field name=\"NHDR-MSG-EC\" wert=\"000\"/>    <field name=\"ADMIN-MSG-TYP\" wert=\"\"/>    <field name=\"NHDR-KW-ALT\" wert=\"\"/>    <field name=\"NHDR-KW-NEU\" wert=\"\"/>    <field name=\"NHDR-MSG-KEY\" wert=\"TK-Portal Stufe2\"/>    <field name=\"NHDR-NHDR-RES\" wert=\"\"/>  </NHDR>  <ELEMENT ebene=\"1\" name=\"LTG-BEZ\">    <OHDR>      <field name=\"Object-Name\" wert=\"LTG-BEZ\"/>      <field name=\"Object-Version\" wert=\"0003\"/>      <field name=\"Object-Len\" wert=\"00281\"/>      <field name=\"Object-Req\" wert=\"0001\"/>      <field name=\"Object-Snd\" wert=\"08176\"/>      <field name=\"Object-Fct\" wert=\"\"/>      <field name=\"Object-RetCode\" wert=\"00\"/>      <field name=\"Object-ErrCode\" wert=\"000\"/>      <field name=\"Reserve\" wert=\"\"/>    </OHDR>    <NHDR ebene=\"2\" name=\"LTG-BEZ000\">      <field name=\"ON-A\" wert=\"05221\"/>      <field name=\"ON-A-SA-OP\" wert=\"\"/>      <field name=\"ON-A-SA-VKN\" wert=\"\"/>      <field name=\"ON-B-GES\" wert=\"00000\"/>      <field name=\"ON-B-SA-OP\" wert=\"\"/>      <field name=\"ON-B-SA-VKN\" wert=\"\"/>      <field name=\"FA-Nummer\" wert=\"1000\"/>      <field name=\"FA-SA-OP\" wert=\"\"/>      <field name=\"FA-SA-VKN\" wert=\"\"/>      <field name=\"Ruf-/Rechnungsnr.\" wert=\"0000802200\"/>      <field name=\"Rufnr-SA-OP\" wert=\"\"/>      <field name=\"Rufnr-SA-VKN\" wert=\"\"/>      <field name=\"Ordnungsnr.\" wert=\"000000\"/>      <field name=\"Ordnr-SA-OP\" wert=\"\"/>      <field name=\"Ordnr-SA-VKN\" wert=\"\"/>      <field name=\"LSZ\" wert=\"96E\"/>      <field name=\"LSZ-SA-OP\" wert=\"\"/>      <field name=\"LSZ-SA-VKN\" wert=\"\"/>      <field name=\"LSZ-ZUK\" wert=\"DSL\"/>      <field name=\"LSZ-Z-SA-OP\" wert=\"\"/>      <field name=\"LSZ-Z-SA-VKN\" wert=\"\"/>      <field name=\"DA\" wert=\"0\"/>      <field name=\"DA-SA-OP\" wert=\"\"/>      <field name=\"DA-SA-VKN\" wert=\"\"/>      <field name=\"Zustand\" wert=\"01\"/>      <field name=\"ZUST-SA-OP\" wert=\"\"/>      <field name=\"ZUST-SA-VKN\" wert=\"\"/>      <field name=\"LTG-DT-AUFH\" wert=\"00000000\"/>      <field name=\"HVTV-Nr.\" wert=\"522-04-17-03/04\"/>      <field name=\"LTG-Notiz\" wert=\"\"/>      <field name=\"LTG-Art-GR\" wert=\"01\"/>      <field name=\"LTG-FARB-KZ\" wert=\"nein\"/>      <field name=\"LTG-NB\" wert=\"\"/>      <field name=\"LTG-SA\" wert=\"\"/>    </NHDR>  </ELEMENT>  <ELEMENT ebene=\"1\" name=\"SCHAKOPF\">    <OHDR>      <field name=\"Object-Name\" wert=\"SCHAKOPF\"/>      <field name=\"Object-Version\" wert=\"0001\"/>      <field name=\"Object-Len\" wert=\"00237\"/>      <field name=\"Object-Req\" wert=\"0001\"/>      <field name=\"Object-Snd\" wert=\"0001\"/>      <field name=\"Object-Fct\" wert=\"\"/>      <field name=\"Object-RetCode\" wert=\"00\"/>      <field name=\"Object-ErrCode\" wert=\"000\"/>      <field name=\"Reserve\" wert=\"\"/>    </OHDR>    <NHDR ebene=\"2\" name=\"SCHAKOPF001\">      <field name=\"KO-UEBER\" wert=\"Auskunft über geschaltete OAsl\"/>      <field name=\"KO-ATNR\" wert=\"\"/>      <field name=\"KO-DT-AUSF\" wert=\"20110117\"/>      <field name=\"KO-STARKSTR\" wert=\"0\"/>      <field name=\"KO-ERK-ON-1\" wert=\"\"/>      <field name=\"KO-ERK-1\" wert=\"\"/>      <field name=\"KO-ERK-ON-2\" wert=\"\"/>      <field name=\"KO-ERK-2\" wert=\"\"/>      <field name=\"KO-LTG-ZUSTAND\" wert=\"\"/>      <field name=\"KO-ALT-RUFNR\" wert=\"\"/>      <field name=\"KO-UEB-ATNR\" wert=\"\"/>      <field name=\"KO-U-VORH\" wert=\"000\"/>      <field name=\"KO-P-RUFNR\" wert=\"\"/>      <field name=\"KO-P-LSZ-Z\" wert=\"\"/>      <field name=\"KO-STIFTE-ZWR\" wert=\"N\"/>    </NHDR>  </ELEMENT>  <ELEMENT ebene=\"1\" name=\"SPR-ANS\">    <OHDR>      <field name=\"Object-Name\" wert=\"SPR-ANS\"/>      <field name=\"Object-Version\" wert=\"0001\"/>      <field name=\"Object-Len\" wert=\"00307\"/>      <field name=\"Object-Req\" wert=\"0002\"/>      <field name=\"Object-Snd\" wert=\"00512\"/>      <field name=\"Object-Fct\" wert=\"\"/>      <field name=\"Object-RetCode\" wert=\"00\"/>      <field name=\"Object-ErrCode\" wert=\"000\"/>      <field name=\"Reserve\" wert=\"\"/>    </OHDR>    <NHDR ebene=\"2\" name=\"SPR-ANS000\">      <field name=\"ANS-LTG-TEIL\" wert=\"A\"/>      <field name=\"SPR-Name1\" wert=\"Qone-Nine-Jagdschnitter\"/>      <field name=\"SPR-Name2\" wert=\"\"/>      <field name=\"SPR-ZUS-Empfänger\" wert=\"\"/>      <field name=\"SPR-PLZ\" wert=\"32051\"/>      <field name=\"SPR-Ort\" wert=\"Herford\"/>      <field name=\"SPR-Ortsteil\" wert=\"\"/>      <field name=\"SPR-Straße\" wert=\"Annastr.\"/>      <field name=\"SPR-Hausnummer\" wert=\"0005\"/>      <field name=\"SPR-Hausnummernzusatz\" wert=\"\"/>      <field name=\"SPR-Gebäudeteil\" wert=\"\"/>      <field name=\"SPR-Gebäudeteilzusatz\" wert=\"\"/>      <field name=\"SPR-Land\" wert=\"\"/>      <field name=\"SPR-Ausl-ZPA\" wert=\"\"/>    </NHDR>  </ELEMENT>  <ELEMENT ebene=\"1\" name=\"HVTV-NR\">    <OHDR>      <field name=\"Object-Name\" wert=\"HVTV-NR\"/>      <field name=\"Object-Version\" wert=\"0001\"/>      <field name=\"Object-Len\" wert=\"00192\"/>      <field name=\"Object-Req\" wert=\"0001\"/>      <field name=\"Object-Snd\" wert=\"0001\"/>      <field name=\"Object-Fct\" wert=\"\"/>      <field name=\"Object-RetCode\" wert=\"00\"/>      <field name=\"Object-ErrCode\" wert=\"000\"/>      <field name=\"Reserve\" wert=\"\"/>    </OHDR>    <NHDR ebene=\"2\" name=\"HVTV-NR001\">      <field name=\"HVTV-NR-AB\" wert=\"521 04 27 02C\"/>      <field name=\"HVTV-NR-2\" wert=\"\"/>      <field name=\"VSTKNR\" wert=\"521--T9---D\"/>      <field name=\"ANP-ART\" wert=\"BED:BaAs/93V\"/>      <field name=\"VERR-AUFTNEHM\" wert=\"BFU-\"/>      <field name=\"OFFENE-VERR\" wert=\"N\"/>      <field name=\"FNB\" wert=\"\"/>      <field name=\"KOLL-ART\" wert=\"00\"/>      <field name=\"KABEL-VERB-ART\" wert=\"\"/>      <field name=\"UEVT-DA1-UEVT\" wert=\"\"/>      <field name=\"UEVT-DA1-EVS\" wert=\"00\"/>      <field name=\"UEVT-DA1-STIFT\" wert=\"00\"/>      <field name=\"UEVT-DA2-UEVT\" wert=\"\"/>      <field name=\"UEVT-DA2-EVS\" wert=\"00\"/>      <field name=\"UEVT-DA2-STIFT\" wert=\"00\"/>      <field name=\"HVTV-UEVT-DA1-BUCHT\" wert=\"000\"/>      <field name=\"HVTV-UEVT-DA1-ZEILE\" wert=\"00\"/>      <field name=\"HVTV-UEVT-DA1-FE\" wert=\"00\"/>      <field name=\"HVTV-UEVT-DA1-STIFT\" wert=\"\"/>      <field name=\"HVTV-UEVT-DA2-BUCHT\" wert=\"000\"/>      <field name=\"HVTV-UEVT-DA2-ZEILE\" wert=\"00\"/>      <field name=\"HVTV-UEVT-DA2-FE\" wert=\"00\"/>      <field name=\"HVTV-UEVT-DA2-STIFT\" wert=\"\"/>      <field name=\"HVTL-UEVT-DA1-REIHE\" wert=\"000\"/>      <field name=\"HVTL-UEVT-DA1-LEISTE\" wert=\"00\"/>      <field name=\"HVTL-UEVT-DA1-STIFT\" wert=\"000\"/>      <field name=\"HVTL-UEVT-DA2-REIHE\" wert=\"000\"/>      <field name=\"HVTL-UEVT-DA2-LEISTE\" wert=\"00\"/>      <field name=\"HVTL-UEVT-DA2-STIFT\" wert=\"000\"/>    </NHDR>  </ELEMENT>  <ELEMENT ebene=\"1\" name=\"LTG-DAT\">    <OHDR>      <field name=\"Object-Name\" wert=\"LTG-DAT\"/>      <field name=\"Object-Version\" wert=\"0001\"/>      <field name=\"Object-Len\" wert=\"00258\"/>      <field name=\"Object-Req\" wert=\"0002\"/>      <field name=\"Object-Snd\" wert=\"0123\"/>      <field name=\"Object-Fct\" wert=\"\"/>      <field name=\"Object-RetCode\" wert=\"00\"/>      <field name=\"Object-ErrCode\" wert=\"000\"/>      <field name=\"Reserve\" wert=\"\"/>    </OHDR>    <NHDR ebene=\"2\" name=\"LTG-DAT000\">      <field name=\"DAT-LTG-TEIL\" wert=\"A\"/>      <field name=\"LTG-HVT\" wert=\"0006\"/>      <field name=\"LTG-LÄNGE\" wert=\"000928\"/>      <field name=\"LTG-WDST\" wert=\"0236\"/>      <field name=\"LTG-WDST-X\" wert=\"J\"/>      <field name=\"LTG-DAEM\" wert=\"0667\"/>      <field name=\"LTG-DAEM-X\" wert=\"J\"/>      <field name=\"LL-Entf\" wert=\"0000000\"/>      <field name=\"LL-Entf-X\" wert=\"N\"/>      <field name=\"Masken-Literale\" wert=\"\"/>      <field name=\"HINWEIS-ZL01\" wert=\"\"/>      <field name=\"HINWEIS-ZL02\" wert=\"\"/>      <field name=\"ART-SWS\" wert=\"\"/>      <field name=\"LTG-UE-VERFAHREN\" wert=\"ADSL2+\"/>      <field name=\"LTG-UE-RATE\" wert=\"16 Mbit/s\"/>    </NHDR>  </ELEMENT>  <ELEMENT ebene=\"1\" name=\"SCHALTE\">    <OHDR>      <field name=\"Object-Name\" wert=\"SCHALTE\"/>      <field name=\"Object-Version\" wert=\"0001\"/>      <field name=\"Object-Len\" wert=\"00616\"/>      <field name=\"Object-Req\" wert=\"0021\"/>      <field name=\"Object-Snd\" wert=\"0123\"/>      <field name=\"Object-Fct\" wert=\"\"/>      <field name=\"Object-RetCode\" wert=\"00\"/>      <field name=\"Object-ErrCode\" wert=\"000\"/>      <field name=\"Reserve\" wert=\"\"/>    </OHDR>    <NHDR ebene=\"2\" name=\"SCHALTE000\">      <field name=\"SCHE-LTG-TEIL\" wert=\"A\"/>      <field name=\"ON\" wert=\"05221\"/>      <field name=\"ASB\" wert=\"0002\"/>      <field name=\"SCHE-TYP\" wert=\"06\"/>      <field name=\"SCHE-ID\" wert=\"A000.007\"/>      <field name=\"HVT-Reihe\" wert=\"000\"/>      <field name=\"HVT-Leiste\" wert=\"00\"/>      <field name=\"EVS-Nr.-ank\" wert=\"000\"/>      <field name=\"SCHE-STBE-ank\" wert=\"\"/>      <field name=\"STIFT-HINW-ank\" wert=\"\"/>      <field name=\"Stift-ank\" wert=\"0000\"/>      <field name=\"Stift-STBE-ank\" wert=\"\"/>      <field name=\"EVS-Nr.-abg\" wert=\"\"/>      <field name=\"SCHE-STBE-abg\" wert=\"N\"/>      <field name=\"STIFT-HINW-abg\" wert=\"\"/>      <field name=\"Stift-abg\" wert=\"0001\"/>      <field name=\"Stift-STBE-abg\" wert=\"N\"/>      <field name=\"Stift-Besken\" wert=\"\"/>      <field name=\"SCHE-PLZ\" wert=\"32051\"/>      <field name=\"SCHE-ORT\" wert=\"Herford\"/>      <field name=\"SCHE-ORTT\" wert=\"\"/>      <field name=\"SCHE-Straße\" wert=\"Annastr.\"/>      <field name=\"SCHE-Hausnr.\" wert=\"0005\"/>      <field name=\"SCHE-Hausnr.-Zus\" wert=\"\"/>      <field name=\"SCHE-GEBT\" wert=\"\"/>      <field name=\"SCHE-GEBT-ZU\" wert=\"\"/>      <field name=\"SCHE-Lage\" wert=\"\"/>      <field name=\"APL-ANBRART\" wert=\"\"/>      <field name=\"EVS-Kennung Ank.\" wert=\"\"/>      <field name=\"EVS-Kennung Abg.\" wert=\"\"/>      <field name=\"Kabel-Typ\" wert=\"\"/>      <field name=\"Kabel-Kennung\" wert=\"A/6(166-173)\"/>      <field name=\"KAB-Laenge-1\" wert=\"0000\"/>      <field name=\"KAB-Durchm-1\" wert=\"000\"/>      <field name=\"KAB-Laenge-2\" wert=\"0000\"/>      <field name=\"KAB-Durchm-2\" wert=\"000\"/>      <field name=\"KAB-Laenge-3\" wert=\"0000\"/>      <field name=\"KAB-Durchm-3\" wert=\"000\"/>      <field name=\"KAB-Laenge-4\" wert=\"0177\"/>      <field name=\"KAB-Durchm-4\" wert=\"500\"/>      <field name=\"KAB-Laenge-5\" wert=\"0751\"/>      <field name=\"KAB-Durchm-5\" wert=\"400\"/>    </NHDR>    <NHDR ebene=\"2\" name=\"SCHALTE001\">      <field name=\"SCHE-LTG-TEIL\" wert=\"A\"/>      <field name=\"ON\" wert=\"05221\"/>      <field name=\"ASB\" wert=\"0002\"/>      <field name=\"SCHE-TYP\" wert=\"01\"/>      <field name=\"SCHE-ID\" wert=\"A000.000\"/>      <field name=\"HVT-Reihe\" wert=\"014\"/>      <field name=\"HVT-Leiste\" wert=\"04\"/>      <field name=\"EVS-Nr.-ank\" wert=\"000\"/>      <field name=\"SCHE-STBE-ank\" wert=\"N\"/>      <field name=\"STIFT-HINW-ank\" wert=\"\"/>      <field name=\"Stift-ank\" wert=\"0066\"/>      <field name=\"Stift-STBE-ank\" wert=\"N\"/>      <field name=\"EVS-Nr.-abg\" wert=\"\"/>      <field name=\"SCHE-STBE-abg\" wert=\"\"/>      <field name=\"STIFT-HINW-abg\" wert=\"\"/>      <field name=\"Stift-abg\" wert=\"0000\"/>      <field name=\"Stift-STBE-abg\" wert=\"\"/>      <field name=\"Stift-Besken\" wert=\"\"/>      <field name=\"SCHE-PLZ\" wert=\"32051\"/>      <field name=\"SCHE-ORT\" wert=\"Herford\"/>      <field name=\"SCHE-ORTT\" wert=\"\"/>      <field name=\"SCHE-Straße\" wert=\"Johannstr.\"/>      <field name=\"SCHE-Hausnr.\" wert=\"0047\"/>      <field name=\"SCHE-Hausnr.-Zus\" wert=\"\"/>      <field name=\"SCHE-GEBT\" wert=\"\"/>      <field name=\"SCHE-GEBT-ZU\" wert=\"\"/>      <field name=\"SCHE-Lage\" wert=\"\"/>      <field name=\"APL-ANBRART\" wert=\"\"/>      <field name=\"EVS-Kennung Ank.\" wert=\"\"/>      <field name=\"EVS-Kennung Abg.\" wert=\"\"/>      <field name=\"Kabel-Typ\" wert=\"\"/>      <field name=\"Kabel-Kennung\" wert=\"\"/>      <field name=\"KAB-Laenge-1\" wert=\"0000\"/>      <field name=\"KAB-Durchm-1\" wert=\"000\"/>      <field name=\"KAB-Laenge-2\" wert=\"0000\"/>      <field name=\"KAB-Durchm-2\" wert=\"000\"/>      <field name=\"KAB-Laenge-3\" wert=\"0000\"/>      <field name=\"KAB-Durchm-3\" wert=\"000\"/>      <field name=\"KAB-Laenge-4\" wert=\"0000\"/>      <field name=\"KAB-Durchm-4\" wert=\"000\"/>      <field name=\"KAB-Laenge-5\" wert=\"0000\"/>      <field name=\"KAB-Durchm-5\" wert=\"000\"/>    </NHDR>  </ELEMENT> \n" +
            "</ELEMENT> ";



    private static final String XSLT_RESOURCE = "<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n" +
            "<xsl:stylesheet version='1.0'\n" +
            "                xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>\n" +
            "    <xsl:template match=\"ELEMENT\">\n" +
            "        <ANTWORT-NACHRICHT>\n" +
            "            <xsl:for-each select=\"ELEMENT\">\n" +
            "                <xsl:for-each select=\"NHDR\">\n" +
            "                    <xsl:if test=\"@name = 'LTG-BEZ000'\">\n" +
            "                        <xsl:for-each select=\"field\">\n" +
            "                            <xsl:if test=\"@name = 'ON-A'\">\n" +
            "                                <ANTWORT-ONKZ>\n" +
            "                                    <xsl:choose>\n" +
            "                                        <xsl:when test=\"@wert = ''\">NaN</xsl:when>\n" +
            "                                        <xsl:otherwise>\n" +
            "                                            <xsl:number value=\"@wert\" format=\"1\" grouping-separator=\".\"/>\n" +
            "                                        </xsl:otherwise>\n" +
            "                                    </xsl:choose>\n" +
            "                                </ANTWORT-ONKZ>\n" +
            "                            </xsl:if>\n" +
            "                            <xsl:if test=\"@name = 'Ruf-/Rechnungsnr.'\">\n" +
            "                                <ANTWORT-RUFNUMMER>\n" +
            "                                    <xsl:choose>\n" +
            "                                        <xsl:when test=\"@wert = ''\">NaN</xsl:when>\n" +
            "                                        <xsl:otherwise>\n" +
            "                                            <xsl:number value=\"@wert\" format=\"1\" grouping-separator=\".\"/>\n" +
            "                                        </xsl:otherwise>\n" +
            "                                    </xsl:choose>\n" +
            "                                </ANTWORT-RUFNUMMER>\n" +
            "                            </xsl:if>\n" +
            "                            <xsl:if test=\"@name = 'Ordnungsnr.'\">\n" +
            "                                <ANTWORT-ORDNUNGSNUMMER>\n" +
            "                                    <xsl:choose>\n" +
            "                                        <xsl:when test=\"@wert = ''\">NaN</xsl:when>\n" +
            "                                        <xsl:otherwise>\n" +
            "                                            <xsl:number value=\"@wert\" format=\"1\" grouping-separator=\".\"/>\n" +
            "                                        </xsl:otherwise>\n" +
            "                                    </xsl:choose>\n" +
            "                                </ANTWORT-ORDNUNGSNUMMER>\n" +
            "                            </xsl:if>\n" +
            "                            <xsl:if test=\"@name = 'LSZ'\">\n" +
            "                                <ANTWORT-LSZ>\n" +
            "                                    <xsl:value-of select=\"@wert\"/>\n" +
            "                                </ANTWORT-LSZ>\n" +
            "                            </xsl:if>\n" +
            "                        </xsl:for-each>\n" +
            "                    </xsl:if>\n" +
            "                </xsl:for-each>\n" +
            "            </xsl:for-each>\n" +
            "        </ANTWORT-NACHRICHT>\n" +
            "    </xsl:template>\n" +
            "</xsl:stylesheet> \n";





    public static void main(String[] args) throws TransformerException, UnsupportedEncodingException {



        StreamSource xsltSource = new StreamSource(new StringReader(XSLT_RESOURCE));
        Transformer transformer = TransformerFactory.newInstance().newTransformer(xsltSource);

            transformer.setOutputProperty(OutputKeys.ENCODING, "ISO-8859-1");
            StringWriter xmlResult = new StringWriter();
            transformer.transform(new StreamSource(new StringReader(XML_SOURCE)), new StreamResult(xmlResult));
            System.out.println(xmlResult.getBuffer().toString());
    }
}
